<html>
  <head>
    <title>File Upload to S3</title>
    <link rel="stylesheet" href="index.css" />
  </head>
  <body>
    <div>
      <h1>Upload File to S3</h1>
      <input type="file" id="fileInput" />
      <button onclick="uploadFile()">Upload</button>
      <p id="status" />
    </div>
    <script>
      async function uploadFile() {
        const fileInput = document.getElementById("fileInput");
        const status = document.getElementById("status");
        const file = fileInput.files[0];

        if (!file) {
          status.textContent = "Please select a file!";
          return;
        }

        const reader = new FileReader();
        reader.readAsDataURL(file);
        reader.onload = async () => {
          const base64File = reader.result.split(",")[1];
          const fileName = file.name;

          const payload = {
            file: base64File,
            fileName: fileName,
          };
          console.log(JSON.stringify(payload));
          try {
            const response = await fetch(
              "https://r71f400s2g.execute-api.us-east-1.amazonaws.com/stag/upload",
              {
                method: "POST",
                headers: {
                  "Content-Type": "application/json",
                },
                body: JSON.stringify(payload),
              }
            );

            const result = await response.json();
            const body = JSON.parse(result.body);
            status.textContent = body.message;
          } catch (error) {
            status.textContent = "Error: " + error.message;
          }
        };
      }
    </script>
  </body>
</html>
